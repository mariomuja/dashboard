<div class="modal-overlay" (click)="cancel()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>
        <span>üéØ</span>
        Edit Goals & Targets
      </h2>
      <button class="close-btn" (click)="cancel()">‚úï</button>
    </div>

    <div class="modal-body">
      <!-- Existing Goals -->
      <section class="form-section">
        <div class="section-header">
          <h3>üìã Current Goals</h3>
          <button class="mat-btn mat-btn-outlined" (click)="addGoal()">
            ‚ûï Add Goal
          </button>
        </div>

        <div class="goals-list">
          <div *ngFor="let goal of goals; let i = index" class="goal-item">
            <div class="goal-item-header">
              <input 
                type="text" 
                [(ngModel)]="goal.title"
                placeholder="Goal Title"
                class="form-input">
              <button class="remove-btn" (click)="removeGoal(i)">üóëÔ∏è</button>
            </div>

            <div class="goal-item-body">
              <div class="form-row">
                <div class="form-group">
                  <label>Current Value</label>
                  <input 
                    type="number" 
                    [(ngModel)]="goal.current"
                    placeholder="0"
                    class="form-input">
                </div>

                <div class="form-group">
                  <label>Target Value</label>
                  <input 
                    type="number" 
                    [(ngModel)]="goal.target"
                    placeholder="0"
                    class="form-input">
                </div>

                <div class="form-group">
                  <label>Unit</label>
                  <select [(ngModel)]="goal.unit" class="form-select">
                    <option value="">None</option>
                    <option value="$">$ (Dollar)</option>
                    <option value="‚Ç¨">‚Ç¨ (Euro)</option>
                    <option value="%">% (Percentage)</option>
                    <option value="K">K (Thousand)</option>
                    <option value="M">M (Million)</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Color</label>
                  <div class="color-picker">
                    <button 
                      *ngFor="let color of colorOptions"
                      type="button"
                      class="color-btn"
                      [class.selected]="goal.color === color"
                      [style.background-color]="color"
                      (click)="goal.color = color">
                    </button>
                  </div>
                </div>
              </div>

              <div class="progress-preview">
                <div class="preview-label">Progress Preview:</div>
                <div class="preview-bar-container">
                  <div 
                    class="preview-bar"
                    [style.width.%]="(goal.current / goal.target) * 100"
                    [style.background-color]="goal.color">
                  </div>
                </div>
                <div class="preview-text">
                  {{ (goal.current / goal.target * 100) | number:'1.0-0' }}% 
                  ({{ goal.current }} / {{ goal.target }})
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="goals.length === 0" class="no-goals">
            No goals yet. Click "Add Goal" to create one.
          </div>
        </div>

        <!-- Add New Goal Form -->
        <div *ngIf="showAddForm" class="add-goal-form">
          <h4>‚ûï New Goal</h4>
          
          <div class="form-group">
            <label>Goal Title *</label>
            <input 
              type="text" 
              [(ngModel)]="newGoal.title"
              placeholder="e.g., Monthly Revenue Target"
              class="form-input">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Current Value *</label>
              <input 
                type="number" 
                [(ngModel)]="newGoal.current"
                placeholder="0"
                class="form-input">
            </div>

            <div class="form-group">
              <label>Target Value *</label>
              <input 
                type="number" 
                [(ngModel)]="newGoal.target"
                placeholder="0"
                class="form-input">
            </div>

            <div class="form-group">
              <label>Unit</label>
              <select [(ngModel)]="newGoal.unit" class="form-select">
                <option value="">None</option>
                <option value="$">$ (Dollar)</option>
                <option value="‚Ç¨">‚Ç¨ (Euro)</option>
                <option value="%">% (Percentage)</option>
                <option value="K">K (Thousand)</option>
                <option value="M">M (Million)</option>
              </select>
            </div>

            <div class="form-group">
              <label>Color</label>
              <div class="color-picker">
                <button 
                  *ngFor="let color of colorOptions"
                  type="button"
                  class="color-btn"
                  [class.selected]="newGoal.color === color"
                  [style.background-color]="color"
                  (click)="newGoal.color = color">
                </button>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button class="mat-btn mat-btn-text" (click)="cancelNewGoal()">Cancel</button>
            <button class="mat-btn mat-btn-filled" (click)="saveNewGoal()">Add Goal</button>
          </div>
        </div>
      </section>
    </div>

    <div class="modal-footer">
      <button class="mat-btn mat-btn-text" (click)="cancel()">
        Cancel
      </button>
      <button class="mat-btn mat-btn-filled" (click)="save()">
        üíæ Save Changes
      </button>
    </div>
  </div>
</div>
