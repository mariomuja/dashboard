<div class="login-container" *ngIf="isReady">
  <div class="login-content">
    <!-- Developer Contact Card -->
    <div class="developer-card" *ngIf="config.showDeveloperCard !== false">
      <div class="developer-photo">
        <img [src]="config.photoUrl || 'mario-muja.jpg'" alt="Mario Muja" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
        <div class="photo-placeholder">MM</div>
      </div>
      <div class="developer-info">
      <p class="developer-greeting">
        Hi, I am <strong>Mario Muja</strong>. I live in Hamburg. This is an application that I have created in my spare free time. 
        If you need support with Angular/TypeScript development or with this app, then you can contact me on my German phone number 
        <a href="tel:+4915204641473">+49 1520 464 1473</a> or at 
        <a href="mailto:mario.muja&#64;gmail.com">mario.muja&#64;gmail.com</a>. 
        I am looking forward to hearing from you! Have a nice day.
      </p>
      <div class="github-link">
        <a [href]="config.githubRepoUrl || 'https://github.com/mariomuja'" target="_blank" rel="noopener noreferrer">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
          </svg>
          <span>View on GitHub</span>
        </a>
      </div>
      </div>
    </div>

    <div class="login-card">
      <div class="login-header">
        <h1>üìä {{ config.appTitle || 'Application' }}</h1>
        <p class="subtitle" *ngIf="!requiresTwoFactor && loginMode === 'demo'">Try the application instantly</p>
        <p class="subtitle" *ngIf="!requiresTwoFactor && loginMode === 'production'">Production Login</p>
        <p class="subtitle" *ngIf="requiresTwoFactor">Two-Factor Authentication</p>
      </div>

    <!-- Quick Demo Mode -->
    <div *ngIf="!requiresTwoFactor && loginMode === 'demo' && config.quickDemoMode" class="quick-demo-mode">
      <div class="demo-info-box">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <h3>üöÄ Instant Demo Access</h3>
        <p>
          <strong>No signup required!</strong> Click the button below to instantly explore the application with sample data.
          All features are unlocked and ready to try.
        </p>
        <p class="demo-note">
          üí° <strong>Note:</strong> Demo data is session-based and isolated. Your changes won't affect other users.
        </p>
      </div>

      <button type="button" class="btn-quick-demo" (click)="quickDemoLogin()" [disabled]="loading">
        <span *ngIf="!loading">üéØ Launch Demo Application</span>
        <span *ngIf="loading">Launching...</span>
      </button>

      <div class="error-message" *ngIf="error">
        {{ error }}
      </div>

      <div class="divider" *ngIf="config?.showProductionLogin">
        <span>or</span>
      </div>

      <button type="button" class="btn-secondary" (click)="switchToProductionLogin()" *ngIf="config?.showProductionLogin">
        üè¢ Production Login
      </button>
    </div>

    <!-- Traditional Login Form (Production Mode) -->
    <form *ngIf="!requiresTwoFactor && loginMode === 'production'" (ngSubmit)="onLogin()" class="login-form">
      <div class="form-group">
        <label for="username">Username</label>
        <input 
          type="text" 
          id="username" 
          name="username"
          [(ngModel)]="username" 
          placeholder="Enter your username"
          [disabled]="loading"
          required
          autofocus>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <div class="password-input-wrapper">
          <input 
            [type]="showPassword ? 'text' : 'password'" 
            id="password" 
            name="password"
            [(ngModel)]="password" 
            placeholder="Enter your password"
            [disabled]="loading"
            required>
          <button 
            type="button" 
            class="password-toggle" 
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'"
            tabindex="-1">
            <svg *ngIf="!showPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            <svg *ngIf="showPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
              <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
          </button>
        </div>
      </div>

      <div class="error-message" *ngIf="error">
        {{ error }}
      </div>

      <button type="submit" class="btn-login" [disabled]="loading">
        <span *ngIf="!loading">Sign In</span>
        <span *ngIf="loading">Signing in...</span>
      </button>

      <div class="divider" *ngIf="config?.quickDemoMode">
        <span>or</span>
      </div>

      <button type="button" class="btn-secondary" (click)="switchToDemoLogin()" *ngIf="config?.quickDemoMode">
        üéØ Try Quick Demo
      </button>

      <!-- OAuth Providers -->
      <div class="oauth-providers" *ngIf="(config?.authenticationMethods?.length ?? 0) > 1">
        <div class="divider">
          <span>or continue with</span>
        </div>
        
        <div class="oauth-buttons">
          <button type="button" class="btn-oauth google" *ngIf="config?.authenticationMethods?.includes('google')" [disabled]="loading">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 48 48">
              <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
              <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
              <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
              <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
            </svg>
            Google
          </button>

          <button type="button" class="btn-oauth microsoft" *ngIf="config?.authenticationMethods?.includes('microsoft')" [disabled]="loading">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 48 48">
              <path fill="#ff5722" d="M6 6h16v16H6z"></path>
              <path fill="#4caf50" d="M26 6h16v16H26z"></path>
              <path fill="#ffc107" d="M6 26h16v16H6z"></path>
              <path fill="#03a9f4" d="M26 26h16v16H26z"></path>
            </svg>
            Microsoft
          </button>

          <button type="button" class="btn-oauth github" *ngIf="config?.authenticationMethods?.includes('github')" [disabled]="loading">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            GitHub
          </button>

          <button type="button" class="btn-oauth activeDirectory" *ngIf="config?.authenticationMethods?.includes('activeDirectory')" [disabled]="loading">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="9" y1="3" x2="9" y2="21"></line>
            </svg>
            Active Directory
          </button>
        </div>
      </div>
    </form>

    <!-- 2FA Verification Form -->
    <form *ngIf="requiresTwoFactor" (ngSubmit)="onVerify2FA()" class="login-form">
      <div class="form-group">
        <label for="twoFactorCode">Enter your 6-digit code</label>
        <input 
          type="text" 
          id="twoFactorCode" 
          name="twoFactorCode"
          [(ngModel)]="twoFactorCode" 
          placeholder="000000"
          maxlength="6"
          [disabled]="loading"
          required
          autofocus
          class="code-input">
        <p class="help-text">Open Google Authenticator to get your code</p>
      </div>

      <div class="error-message" *ngIf="error">
        {{ error }}
      </div>

      <div class="button-group">
        <button type="button" class="btn-secondary" (click)="cancelTwoFactor()" [disabled]="loading">
          Back
        </button>
        <button type="submit" class="btn-login" [disabled]="loading">
          <span *ngIf="!loading">Verify</span>
          <span *ngIf="loading">Verifying...</span>
        </button>
      </div>
    </form>
    </div>
  </div>

  <div class="login-footer">
    <p>International Bookkeeping ¬© 2025 | Secure Double-Entry Bookkeeping</p>
  </div>
</div>

